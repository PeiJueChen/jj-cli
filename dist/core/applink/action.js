"use strict";const e=require("../../untils/logs"),a=require("../../untils/common"),{platforms:r}=require("../../constants/platforms"),t=require("../../untils/parse-config"),o=async(o,n,l)=>{const s=o&&o.toLowerCase().trim();var i=r[s];if(!i){let t=await a.askPlatform();if(!(i=r[t]))return void e.logFatal(`Only support ${r} now.`)}const{config:p,configPathDiretory:c}=await t.parseConfigPromise(n);try{var u=await t.askProjects(p,null)}catch(a){e.logFatal("Please write all `project` field as project name")}if(!u)return void e.logFatal("Please write all `project` field as project name");var g=(null==u?void 0:u.pgyer)||(null==u?void 0:u.appcenter);l&&(g=null==u?void 0:u.appcenter);const m=!(null==u||!u.pgyer);if(!g)return void e.logFatal("missing appcenter or pgyer");const f=g[i];if(!f)return void e.logFatal("missing appInfo");const d=Object.keys(f).filter((e=>{const a=f[e],r="object"==typeof a&&Object.keys(a).length>0;return m?r:r&&a.userName&&a.appName&&a.group}));0===d.length&&e.logFatal("Please check your jj.config.json, Cannot find userName/appName/group");var j=await a.askSelectList(d,"Group");const v=f[j],y=null==v?void 0:v.channel;if(m&&y){var w=`https://www.pgyer.com/${y}`;if(!y)return void e.logFatal("missing channel")}else{v.userName&&v.appName&&v.group||e.logFatal("Please check your jj.config.json, Cannot find userName/appName/group"),w=`https://install.appcenter.ms/users/${v.userName}/apps/${v.appName}/distribution_groups/${v.group}`}e.logFriendly("Your app link: "+w),await a.openUrl(w)};module.exports={applink:o};